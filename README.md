# 🏓 桌球旋轉速度偵測系統 (Table Tennis Spin Tracking System)

本專案旨在開發一套以 **雙相機與 YOLOv11 影像辨識技術** 為核心的 **桌球旋轉速度偵測系統**。  
透過雙相機立體視覺、攝影機標定、深度學習物件偵測與 3D 重建技術，實現桌球在空間中的 **旋轉軸與角速度估算**。

---

## 系統概述

本系統採用兩台同步攝影機拍攝桌球運動影像，並結合YOLOv11兩階段偵測與3D重建演算法，  
以高精度重建桌球的三維位置與旋轉資訊。

<p align="center">
  <img src="docs/system_overview.png" width="700">
</p>

---

## 系統功能特色

### 1.雙相機校正
- 透過拍攝棋盤格圖案進行雙相機標定。  
- 採用 **張氏標定法 (Zhang’s Camera Calibration Method)**，獲得以下參數：
  - 內部參數矩陣 **K**
  - 外部參數 **R、T**
  - 畸變係數 **Distortion coefficients**
- 校正結果將用於後續立體視覺重建。

---

### 2.YOLOv11 兩階段偵測
- **階段一：** 在完整畫面中偵測並追蹤 **桌球位置**。  
- **階段二：** 在第一階段的結果中，進一步偵測 **球面標記** 以分析旋轉方向與角度變化。

> 兩階段皆使用 YOLOv11 訓練之自建資料集，適用於室內高速拍攝環境。

---

### 3.立體視覺 3D 座標重建
- 根據雙相機校正所得投影矩陣進行三維重建。  
- 將左右畫面中對應的桌球與球面標記匹配後，透過三角測量求出其 3D 座標。

公式如下：
\[
X = \text{triangulate}(K_1, R_1, T_1, K_2, R_2, T_2, x_1, x_2)
\]

---

### 4️⃣ 旋轉速度計算 (Spin Rate Estimation)
- 根據連續幀中標記點的角度變化，計算旋轉位移 Δθ。  
- 結合時間差 Δt，估算旋轉角速度：
\[
\omega = \frac{\Delta \theta}{\Delta t}
\]
- 可視化輸出包括：
  - 桌球旋轉軸方向  
  - 每幀角速度曲線  
  - 三維旋轉軌跡重建圖  

---
